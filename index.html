<!DOCTYPE html>
<html>

<head>
  <title>Page Title</title>
  <style>
    /* Add some basic styling for the loader */
    .loader {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 4px solid #ccc;
      border-top: 4px solid #1DB954;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body>
  <div style="display: flex; align-items: center; justify-content: center; height: 100vh;">
    <div class="loader"></div>
    <span style="margin-left: 10px;">Loading Spotify...</span>
  </div>

  <script>
    // Define the function to update the button link and redirect to Spotify
    function redirectToSpotify() {
      // Make a request to the JSON link
      fetch("https://api.radioking.io/widget/radio/satvrno/track/current")
        .then((response) => response.json())
        .then((data) => {
          // Get the song name from the JSON
          const songName = `${data.title} ${data.artist}`;

          // Replace spaces with "%20"
          const encodedSongName = encodeURIComponent(songName);

          // Construct the Spotify search link
          const spotifySearchLink = `https://open.spotify.com/search/${encodedSongName}`;

          // Open the Spotify search link in a new tab after a 2-second delay
          setTimeout(() => {
            window.open(spotifySearchLink, "_blank");
          }, 2000);
        })
        .catch((error) => {
          console.error("Error getting current song: ", error);
        });
    }

    // Call the function to redirect to Spotify when the page loads
    redirectToSpotify();
  </script>
</body>

</html>
